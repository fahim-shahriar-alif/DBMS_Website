<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Board of Directors Dashboard - ASA Data Server</title>
  <link rel="stylesheet" href="css/dashboard.css">
  <link rel="stylesheet" href="css/table.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 30px;
      border-radius: 12px;
      color: white;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .stat-card.governance {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
    }

    .stat-card.financial {
      background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
    }

    .stat-card.risk {
      background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
    }

    .stat-card.strategic {
      background: linear-gradient(135deg, #8e44ad 0%, #9b59b6 100%);
    }

    .stat-card h3 {
      margin: 0 0 15px 0;
      font-size: 16px;
      opacity: 0.9;
      font-weight: 600;
    }

    .stat-card .value {
      font-size: 36px;
      font-weight: bold;
      margin: 15px 0;
    }

    .stat-card .change {
      font-size: 14px;
      opacity: 0.8;
    }

    .governance-overview {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .governance-card {
      background: white;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      border-left: 5px solid #2c3e50;
    }

    .governance-card h3 {
      margin-top: 0;
      color: #2c3e50;
      font-size: 18px;
    }

    .governance-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .governance-item:last-child {
      border-bottom: none;
    }

    .status-indicator {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
    }

    .status-compliant {
      background: #d5f4e6;
      color: #27ae60;
    }

    .status-review {
      background: #fef9e7;
      color: #f39c12;
    }

    .status-critical {
      background: #fadbd8;
      color: #e74c3c;
    }

    .board-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .action-card {
      background: white;
      padding: 25px;
      border-radius: 10px;
      border: 2px solid #e0e0e0;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
    }

    .action-card:hover {
      border-color: #2c3e50;
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .action-card .icon {
      font-size: 36px;
      margin-bottom: 15px;
    }

    .action-card h4 {
      margin: 0;
      color: #2c3e50;
      font-size: 16px;
    }

    .charts-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .chart-card {
      background: white;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .chart-card h3 {
      margin-top: 0;
      color: #2c3e50;
      font-size: 18px;
    }

    .fiduciary-summary {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white;
      padding: 30px;
      border-radius: 12px;
      margin-bottom: 20px;
    }

    .fiduciary-summary h2 {
      margin-top: 0;
      font-size: 24px;
    }

    .fiduciary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .fiduciary-item {
      text-align: center;
    }

    .fiduciary-value {
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .fiduciary-label {
      font-size: 14px;
      opacity: 0.8;
    }
  </style>
</head>

<body>
  <nav class="navbar">
    <div class="nav-brand">
      <h2>ğŸ›ï¸ ASA Board Portal</h2>
      <p style="font-size: 12px; margin: 0; color: #ddd;" id="boardName">Board of Directors</p>
    </div>
    <ul class="nav-menu">
      <li><a href="board-directors-dashboard.html" class="active">ğŸ“Š Board Dashboard</a></li>
      <li><a href="companies-functional.html">ğŸ¢ Corporate Governance</a></li>
      <li><a href="institutions-functional.html">ğŸ›ï¸ Strategic Partners</a></li>
      <li><a href="audit-reports-functional.html">ğŸ“‹ Audit Oversight</a></li>
      <li><a href="fraud-alerts-functional.html">âš ï¸ Risk Monitoring</a></li>
      <li><a href="predictions-functional.html">ğŸ”® Strategic Forecasts</a></li>
      <li><a href="transactions-functional.html">ğŸ’° Financial Overview</a></li>
      <li><a href="trades-functional.html">ğŸ”„ Trading Activity</a></li>
      <li><a href="investors-functional.html">ğŸ‘¤ Investor Relations</a></li>
      <li><a href="stocks-functional.html">ğŸ“ˆ Market Performance</a></li>
      <li><a href="price-history-functional.html">ğŸ“Š Market Trends</a></li>
      <li><a href="#" class="logout" onclick="handleLogout()">ğŸšª Logout</a></li>
    </ul>
  </nav>

  <div class="main-content">
    <div class="welcome-section">
      <h1>Board of Directors Portal</h1>
      <p>Governance, Oversight & Strategic Direction</p>
    </div>

    <div class="fiduciary-summary">
      <h2>ğŸ“Š Fiduciary Overview</h2>
      <div class="fiduciary-grid">
        <div class="fiduciary-item">
          <div class="fiduciary-value" id="totalAssets">$0</div>
          <div class="fiduciary-label">Total Assets Under Management</div>
        </div>
        <div class="fiduciary-item">
          <div class="fiduciary-value" id="shareholderValue">$0</div>
          <div class="fiduciary-label">Shareholder Value</div>
        </div>
        <div class="fiduciary-item">
          <div class="fiduciary-value" id="riskExposure">Low</div>
          <div class="fiduciary-label">Risk Exposure</div>
        </div>
        <div class="fiduciary-item">
          <div class="fiduciary-value" id="complianceScore">98%</div>
          <div class="fiduciary-label">Compliance Score</div>
        </div>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card governance">
        <h3>ğŸ¢ Corporate Entities</h3>
        <div class="value" id="totalCompanies">0</div>
        <div class="change">Under governance</div>
      </div>

      <div class="stat-card financial">
        <h3>ğŸ’° Transaction Volume</h3>
        <div class="value" id="transactionVolume">$0</div>
        <div class="change">Total managed</div>
      </div>

      <div class="stat-card risk">
        <h3>âš ï¸ Risk Alerts</h3>
        <div class="value" id="riskAlerts">0</div>
        <div class="change">Active alerts</div>
      </div>

      <div class="stat-card strategic">
        <h3>ğŸ›ï¸ Strategic Partners</h3>
        <div class="value" id="institutions">0</div>
        <div class="change">Institutional relationships</div>
      </div>
    </div>

    <div class="governance-overview">
      <div class="governance-card">
        <h3>ğŸ“‹ Governance Compliance</h3>
        <div class="governance-item">
          <span>Audit Reports</span>
          <span class="status-indicator status-compliant" id="auditStatus">Compliant</span>
        </div>
        <div class="governance-item">
          <span>Risk Management</span>
          <span class="status-indicator status-review" id="riskStatus">Under Review</span>
        </div>
        <div class="governance-item">
          <span>Regulatory Compliance</span>
          <span class="status-indicator status-compliant" id="regulatoryStatus">Compliant</span>
        </div>
        <div class="governance-item">
          <span>Financial Reporting</span>
          <span class="status-indicator status-compliant" id="financialStatus">Current</span>
        </div>
      </div>

      <div class="governance-card">
        <h3>ğŸ“Š Performance Metrics</h3>
        <div class="governance-item">
          <span>Market Capitalization</span>
          <span style="font-weight: bold; color: #27ae60;" id="marketCap">$2.5B</span>
        </div>
        <div class="governance-item">
          <span>ROI (Annual)</span>
          <span style="font-weight: bold; color: #27ae60;" id="roi">12.5%</span>
        </div>
        <div class="governance-item">
          <span>Investor Satisfaction</span>
          <span style="font-weight: bold; color: #27ae60;" id="satisfaction">94%</span>
        </div>
        <div class="governance-item">
          <span>ESG Score</span>
          <span style="font-weight: bold; color: #27ae60;" id="esgScore">A+</span>
        </div>
      </div>
    </div>

    <div class="board-actions">
      <div class="action-card" onclick="window.location.href='companies-functional.html'">
        <div class="icon">ğŸ¢</div>
        <h4>Corporate Governance</h4>
        <p style="font-size: 12px; color: #7f8c8d; margin: 5px 0 0 0;">Oversee corporate entities</p>
      </div>

      <div class="action-card" onclick="window.location.href='institutions-functional.html'">
        <div class="icon">ğŸ›ï¸</div>
        <h4>Strategic Partners</h4>
        <p style="font-size: 12px; color: #7f8c8d; margin: 5px 0 0 0;">Manage partnerships</p>
      </div>

      <div class="action-card" onclick="window.location.href='audit-reports-functional.html'">
        <div class="icon">ğŸ“‹</div>
        <h4>Audit Oversight</h4>
        <p style="font-size: 12px; color: #7f8c8d; margin: 5px 0 0 0;">Review compliance</p>
      </div>

      <div class="action-card" onclick="window.location.href='fraud-alerts-functional.html'">
        <div class="icon">âš ï¸</div>
        <h4>Risk Monitoring</h4>
        <p style="font-size: 12px; color: #7f8c8d; margin: 5px 0 0 0;">Monitor risk exposure</p>
      </div>

      <div class="action-card" onclick="window.location.href='predictions-functional.html'">
        <div class="icon">ğŸ”®</div>
        <h4>Strategic Planning</h4>
        <p style="font-size: 12px; color: #7f8c8d; margin: 5px 0 0 0;">Future forecasting</p>
      </div>

      <div class="action-card" onclick="window.location.href='investors-functional.html'">
        <div class="icon">ğŸ‘¤</div>
        <h4>Investor Relations</h4>
        <p style="font-size: 12px; color: #7f8c8d; margin: 5px 0 0 0;">Stakeholder engagement</p>
      </div>
    </div>

    <div class="charts-section">
      <div class="chart-card">
        <h3>ğŸ“ˆ Financial Performance Trend</h3>
        <canvas id="performanceChart"></canvas>
      </div>

      <div class="chart-card">
        <h3>ğŸ¢ Portfolio Distribution</h3>
        <canvas id="portfolioChart"></canvas>
      </div>
    </div>
  </div>

  <script src="js/local-database.js"></script>
  <script>
    // Check if board of directors is logged in
    const userRole = sessionStorage.getItem('userRole');
    const boardName = sessionStorage.getItem('userFullName') || 'Board of Directors';
    const isLoggedIn = sessionStorage.getItem('isLoggedIn');

    if (!isLoggedIn || userRole !== 'board-directors') {
      window.location.href = 'login.html';
    }

    // Display board name
    document.getElementById('boardName').textContent = boardName;

    // Load databases
    const companiesDb = new LocalDatabase('companies');
    const institutionsDb = new LocalDatabase('institutions');
    const transactionsDb = new LocalDatabase('transactions');
    const fraudAlertsDb = new LocalDatabase('fraud_alerts');
    const auditReportsDb = new LocalDatabase('audit_reports');
    const stocksDb = new LocalDatabase('stocks');

    function loadDashboardData() {
      const companies = companiesDb.getAll();
      const institutions = institutionsDb.getAll();
      const transactions = transactionsDb.getAll();
      const fraudAlerts = fraudAlertsDb.getAll();
      const auditReports = auditReportsDb.getAll();
      const stocks = stocksDb.getAll();

      // Update governance stats
      document.getElementById('totalCompanies').textContent = companies.length;
      document.getElementById('institutions').textContent = institutions.length;

      // Calculate transaction volume
      const totalVolume = transactions.reduce((sum, t) => sum + parseFloat(t.amount || 0), 0);
      document.getElementById('transactionVolume').textContent = '$' + totalVolume.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 });

      // Count active risk alerts
      const activeAlerts = fraudAlerts.filter(alert => alert.status === 'Active').length;
      document.getElementById('riskAlerts').textContent = activeAlerts;

      // Update fiduciary overview
      const totalAssets = totalVolume * 1.5; // Estimated assets
      document.getElementById('totalAssets').textContent = '$' + totalAssets.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 });
      document.getElementById('shareholderValue').textContent = '$' + (totalAssets * 0.8).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 });

      // Update governance status
      const pendingAudits = auditReports.filter(a => a.status === 'Pending').length;
      if (pendingAudits > 0) {
        document.getElementById('auditStatus').textContent = 'Review Required';
        document.getElementById('auditStatus').className = 'status-indicator status-review';
      }

      if (activeAlerts > 0) {
        document.getElementById('riskStatus').textContent = 'Critical';
        document.getElementById('riskStatus').className = 'status-indicator status-critical';
        document.getElementById('riskExposure').textContent = 'Medium';
      }

      // Load charts
      loadPerformanceChart(transactions);
      loadPortfolioChart(companies);
    }

    function loadPerformanceChart(transactions) {
      const ctx = document.getElementById('performanceChart').getContext('2d');

      // Group transactions by month
      const monthlyData = {};
      transactions.forEach(transaction => {
        const date = new Date(transaction.transaction_date);
        const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
        monthlyData[monthKey] = (monthlyData[monthKey] || 0) + parseFloat(transaction.amount || 0);
      });

      const months = Object.keys(monthlyData).sort().slice(-6);
      const values = months.map(month => monthlyData[month]);

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: months.map(m => {
            const [year, month] = m.split('-');
            return new Date(year, month - 1).toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
          }),
          datasets: [{
            label: 'Financial Performance ($)',
            data: values,
            borderColor: '#2c3e50',
            backgroundColor: 'rgba(44, 62, 80, 0.1)',
            tension: 0.4,
            fill: true
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function (value) {
                  return '$' + value.toLocaleString();
                }
              }
            }
          }
        }
      });
    }

    function loadPortfolioChart(companies) {
      const ctx = document.getElementById('portfolioChart').getContext('2d');

      // Group by sector
      const sectors = {};
      companies.forEach(company => {
        const sector = company.sector || 'Other';
        sectors[sector] = (sectors[sector] || 0) + 1;
      });

      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: Object.keys(sectors),
          datasets: [{
            data: Object.values(sectors),
            backgroundColor: [
              '#2c3e50',
              '#27ae60',
              '#3498db',
              '#e74c3c',
              '#9b59b6',
              '#f39c12',
              '#16a085'
            ]
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });
    }

    function handleLogout() {
      sessionStorage.clear();
      window.location.href = 'login.html';
    }

    // Load data on page load
    loadDashboardData();
  </script>
</body>

</html>